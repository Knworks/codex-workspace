---
id: `HIST-003`
title: `履歴WebView UIと検索プレビュー実装`
status: Done
---

# 🧾`HIST-003 履歴WebView UIと検索プレビュー実装`

## 🎯背景/目的

- 履歴データを閲覧しやすい 2 ペイン UI で提示し、検索による対象セッションの特定を短時間で行えるようにする。

## 📌要件

- 上部検索ペイン + 下部 2 ペイン（左 30% / 右 70%）UI を実装する。
- 左ペインに日付フォルダ（`yyyy/mm/dd`）とタスクカード、右ペインに会話プレビューを表示する。
- 検索はユーザーメッセージ全文を対象に、入力時または Enter で絞り込みとテーマ追従ハイライトを行う。
- 右ペインはユーザー全文、AI回答、思考過程を別枠で表示し、思考過程は折りたたみ表示とする。

## 🛠️スコープ / 作業内容

- WebView の HTML/CSS/TS を実装し、上部検索 + 下部 2 ペインレイアウトとブロック区切り UI を構築する。
- カード選択時に `user_message` 全文と AI タイムライン（assistant/reasoning）を Markdown レンダリングして右ペインへ反映する。
- 検索入力/Enter 実行、クリア（codicon `clear-all`）、ハイライト表示（VS Code テーマ色追従）を実装する。
- ユーザー/AI メッセージのコピー操作（codicon `copy`）を実装する。

## ✅AC（受け入れ基準）

- AC：必要十分な項目数（最低3、目安5〜10、上限なし）
  - [x] [機能] 上部検索 + 下部 2 ペイン（左 30% / 右 70%）で履歴ビューが表示される
  - [x] [機能] 左ペインに日付フォルダ（`yyyy/mm/dd`）と新しい順のタスクカードが表示される
  - [x] [機能] カード選択で右ペインにユーザー全文と AI タイムラインが更新される
  - [x] [機能] 検索は入力時または Enter で実行され、クリアで解除される
  - [x] [UI/UX] ハイライトが VS Code テーマ色に追従し可読性を維持する
  - [x] [UI/UX] ユーザー/AI/思考過程が別枠表示され、思考過程は折りたたみ表示される
  - [x] [UI/UX] ユーザー/AI メッセージにコピーアイコン（codicon `copy`）が表示される
  - [x] [テスト] WebView メッセージング、検索状態遷移、表示件数制御のテストが追加される

## 🔗依存関係

- DependsOn: HIST-001, HIST-002

## 🧪テスト観点

- ユニット / E2E
- 検証方法：
  - WebView の初期描画、カード選択反映、検索実行/解除、ハイライト描画、コピー操作を確認する
