# 🧾 追加・変更要件

## 🏷️ 概要

現在、各種Explorerで編集したファイルは、`.codex` 配下のフォルダを直接編集するものとなっている。  
ユーザーがリポジトリで管理している別フォルダなどがある場合、それぞのファイルを同期するのに、コピーするなどの手間がかかる。  
そのため、以下のエクスプローラーに、同期ボタンを新たに追加し、同期ボタンを押下することで、予め設定した同期フォルダとの同期を実行したい。

- Codex Core
- Prompts Explorer
- Skills Explorer
- Template Explorer

## 🎭 ユースケース / ユーザーストーリー

- **U1**：ユーザーは、Codex Core の同期ボタンを押下することで、`.codex` と同期フォルダの間で最終更新日時が新しいファイルが正として相互同期できる。
- **U2**：ユーザーは、Prompts Explorer の同期ボタンを押下することで、`.codex/prompts` と同期フォルダの間で最終更新日時が新しいファイルが正として相互同期できる。
- **U3**：ユーザーは、Skills Explorer の同期ボタンを押下することで、`.codex/skills` と同期フォルダの間で最終更新日時が新しいファイルが正として相互同期できる。
- **U4**：ユーザーは、Template Explorer の同期ボタンを押下することで、`.codex/codex-templates` と同期フォルダの間で最終更新日時が新しいファイルが正として相互同期できる。

## 🧩 機能要件

- 以下の設定値を追加する。
  - Codex Core Sync Folder：Codex Coreの同期先フォルダのパス（既定値：ブランク）
    - キー：`codexFolder`
  - Prompts Sync Folder：Prompts Explorerの同期先フォルダのパス（既定値：ブランク）
    - キー：`promptsFolder`
  - Skills Sync Folder：Skills Explorerの同期先フォルダのパス（既定値：ブランク）
    - キー：`skillsFolder`
  - Template Sync Folder：Template Explorer の同期先フォルダのパス（既定値：ブランク）
    - キー：`templatesFolder`

- Codex Core
  - 同期ボタンを追加（codeIcon：`sync`）
    - `codexFolder` に値が設定されていない場合は、非表示とする
    - 同期ボタンを押下すると、確認メッセージを表示し、OKボタンを押下した場合、`.codex` 配下の `AGENTS.md` と `config.toml` を `codexFolder` と相互同期する。
      - `.codex` と `codexFolder` の同名ファイルは最終更新日時が新しい方を正として古い方を上書きする。
      - いずれかで削除されたファイルは両方から削除する。
      - 削除同期の判定に必要なメタ情報は `.codex/.codex-sync` に保存し、削除が両方に反映された時点で削除する。
      - `.codex/.codex-sync` 配下は隠しフォルダとして同期対象外とする。
      - 隠しフォルダ/隠しファイルは対象外とする。
      - 上書き中にエラーが発生した場合は該当ファイルのみスキップし、スキップした旨を簡易ダイアログで通知する。
      - メッセージ：`<パス> のファイルを上書きしますがよろしいですか？`
- Prompts Explorer
  - 同期ボタンを追加（codeIcon：`sync`）
    - `promptsFolder` に値が設定されていない場合は、非表示
    - 同期ボタンを押下すると、確認メッセージを表示し、OKボタンを押下した場合、`.codex/prompts` と `promptsFolder` を相互同期する。
      - `.codex/prompts` と `promptsFolder` の同名ファイルは最終更新日時が新しい方を正として古い方を上書きする。
      - いずれかで削除されたファイルは両方から削除する。
      - 削除同期の判定に必要なメタ情報は `.codex/.codex-sync` に保存し、削除が両方に反映された時点で削除する。
      - `.codex/.codex-sync` 配下は隠しフォルダとして同期対象外とする。
      - 隠しフォルダ/隠しファイルは対象外とする。
      - 上書き中にエラーが発生した場合は該当ファイルのみスキップし、スキップした旨を簡易ダイアログで通知する。
      - メッセージ：`<パス> のファイルを上書きしますがよろしいですか？`
- Skills Explorer
  - 同期ボタンを追加（codeIcon：`sync`）
    - `skillsFolder` に値が設定されていない場合は、非表示
    - 同期ボタンを押下すると、確認メッセージを表示し、OKボタンを押下した場合、`.codex/skills` と `skillsFolder` を相互同期する。
      - `.codex/skills` と `skillsFolder` の同名ファイルは最終更新日時が新しい方を正として古い方を上書きする。
      - いずれかで削除されたファイルは両方から削除する。
      - 削除同期の判定に必要なメタ情報は `.codex/.codex-sync` に保存し、削除が両方に反映された時点で削除する。
      - `.codex/.codex-sync` 配下は隠しフォルダとして同期対象外とする。
      - 隠しフォルダ/隠しファイルは対象外とする。
      - 上書き中にエラーが発生した場合は該当ファイルのみスキップし、スキップした旨を簡易ダイアログで通知する。
      - メッセージ：`<パス> のファイルを上書きしますがよろしいですか？`
- Template Explorer
  - 同期ボタンを追加（codeIcon：`sync`）
    - `templatesFolder` に値が設定されていない場合は、非表示
    - 同期ボタンを押下すると、確認メッセージを表示し、OKボタンを押下した場合、`.codex/codex-templates` と `templatesFolder` を相互同期する。
      - `.codex/codex-templates` と `templatesFolder` の同名ファイルは最終更新日時が新しい方を正として古い方を上書きする。
      - いずれかで削除されたファイルは両方から削除する。
      - 削除同期の判定に必要なメタ情報は `.codex/.codex-sync` に保存し、削除が両方に反映された時点で削除する。
      - `.codex/.codex-sync` 配下は隠しフォルダとして同期対象外とする。
      - 隠しフォルダ/隠しファイルは対象外とする。
      - 上書き中にエラーが発生した場合は該当ファイルのみスキップし、スキップした旨を簡易ダイアログで通知する。
      - メッセージ：`<パス> のファイルを上書きしますがよろしいですか？`

## 🛡️ 非機能要件

- 変更なし

## 🔒 制約事項

- 変更なし
