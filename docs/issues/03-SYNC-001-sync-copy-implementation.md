---
id: SYNC-001
title: 同期コピー処理の実装
status: Done
---

# 🧾`SYNC-001 同期コピー処理の実装`

## 🎯背景/目的

- 同期ボタン押下時に `.codex` と同期フォルダを相互同期できるようにするため。

## 📌要件

- 確認メッセージを表示し、OK の場合のみ相互同期を実行する。
- Codex Core は `.codex/AGENTS.md` と `.codex/config.toml` を相互同期する。
- Prompts / Skills / Templates は各ルート配下のファイルを相互同期する。
- 同名ファイルは最終更新日時が新しい方を正として古い方を上書きする。
- いずれかで削除されたファイルは両方から削除する。
- 削除同期の判定に必要なメタ情報は `.codex/.codex-sync` に保存し、削除が両方に反映された時点で削除する。
- `.codex/.codex-sync` 配下は隠しフォルダとして同期対象外とする。
- 隠しフォルダ/隠しファイルは同期対象外とする。
- 上書き中にエラーが発生した場合は該当ファイルのみスキップし、簡易ダイアログで通知する。

## 🛠️スコープ / 作業内容

- 同期対象の列挙と相互同期処理を実装する。
- 最終更新日時の比較と上書き方針を実装する。
- 削除同期の判定と実行を実装する。
- 削除同期メタ情報の保存/削除を実装する。
- 隠しフォルダ/隠しファイルの除外を実装する。
- エラー発生時のスキップと通知を実装する。
- 確認メッセージとスキップ通知をローカライズ対応で追加する。

## ✅AC（受け入れ基準）

- [x] [機能] 確認ダイアログで OK を選択した場合のみ相互同期される。
- [x] [機能] Core/Prompts/Skills/Templates それぞれの対象が正しく相互同期される。
- [x] [機能] 同名ファイルは最終更新日時が新しい方で古い方が上書きされる。
- [x] [機能] いずれかで削除されたファイルは両方から削除される。
- [x] [機能] 削除同期メタ情報が `.codex/.codex-sync` に保存され、削除完了時に削除される。
- [x] [機能] `.codex/.codex-sync` 配下は同期対象外である。
- [x] [機能] 隠しフォルダ/隠しファイルは同期対象外である。
- [x] [機能] 上書き中にエラーが発生した場合は該当ファイルのみスキップされる。
- [x] [UI/UX] スキップした旨の簡易ダイアログが表示される。
- [x] [UI/UX] 確認メッセージが日本語/英語で表示される。
- [x] [テスト] 同期対象の列挙と相互同期処理のテストが追加されている。

## 🔗依存関係

- DependsOn: CONFIG-001, UI-001

## 🧪テスト観点

- (ユニット / リクエスト)
- 検証方法：更新日時の比較、隠し除外、エラー時のスキップと通知を確認する。
